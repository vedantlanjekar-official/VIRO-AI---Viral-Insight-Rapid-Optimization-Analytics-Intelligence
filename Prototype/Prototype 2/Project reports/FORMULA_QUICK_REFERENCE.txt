╔════════════════════════════════════════════════════════════════════════════╗
║                    VIRO-AI FORMULA QUICK REFERENCE                         ║
║                      Key Equations & Methods                               ║
╚════════════════════════════════════════════════════════════════════════════╝

┌────────────────────────────────────────────────────────────────────────────┐
│ 1. CORE PREDICTION MODEL                                                   │
└────────────────────────────────────────────────────────────────────────────┘

  Random Forest Ensemble:
  ┌─────────────────────────────────────────┐
  │ ŷ = (1/300) × Σ Tree_i(X)              │
  │                                         │
  │ where:                                  │
  │   ŷ = predicted pIC50                  │
  │   X = 27-dimensional feature vector    │
  │   300 trees, depth=4, min_samples=8    │
  └─────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────┐
│ 2. IC50 ↔ pIC50 CONVERSION                                                 │
└────────────────────────────────────────────────────────────────────────────┘

  IC50 to pIC50:
  ┌─────────────────────────────────────────┐
  │ pIC50 = -log₁₀(IC50_nM × 10⁻⁹)         │
  │       = -log₁₀(IC50_nM) + 9            │
  └─────────────────────────────────────────┘
  
  Example: IC50 = 100 nM → pIC50 = 7.0

  pIC50 to IC50:
  ┌─────────────────────────────────────────┐
  │ IC50_nM = 10^(9 - pIC50)               │
  └─────────────────────────────────────────┘
  
  Example: pIC50 = 7.5 → IC50 = 31.6 nM

┌────────────────────────────────────────────────────────────────────────────┐
│ 3. FEATURE ENGINEERING (27 Features)                                       │
└────────────────────────────────────────────────────────────────────────────┘

  From SMILES String:
  ┌─────────────────────────────────────────┐
  │ F₁  = length(SMILES)                    │
  │ F₂  = count('C')  # Carbon atoms        │
  │ F₃  = count('N')  # Nitrogen atoms      │
  │ F₄  = count('O')  # Oxygen atoms        │
  │ ...                                     │
  │ F₁₀ = count('=')  # Double bonds        │
  │ F₁₁ = count('#')  # Triple bonds        │
  │ F₁₂ = count('(')  # Branches            │
  │ ...                                     │
  │ F₂₂ = len(SMILES) / (count('C') + 1)   │
  │ F₂₃ = (count('=') + count('#')) / len  │
  │ F₂₄ = count('(') / len                  │
  │ F₂₅ = ring_density                      │
  │ F₂₆ = molecular_weight                  │
  │ F₂₇ = logP                              │
  └─────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────┐
│ 4. FEATURE SCALING (Z-score Normalization)                                │
└────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────┐
  │ X_scaled = (X - μ) / σ                 │
  │                                         │
  │ where:                                  │
  │   μ = mean from training set           │
  │   σ = std dev from training set        │
  └─────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────┐
│ 5. BINDING SCORE (0-1 Normalization)                                      │
└────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────┐
  │ Binding_Score = (pIC50 - min) / range  │
  │                                         │
  │ where:                                  │
  │   min = pIC50_min in batch             │
  │   range = pIC50_max - pIC50_min        │
  │                                         │
  │ Result: 0 (worst) to 1 (best)          │
  └─────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────┐
│ 6. BINDING STRENGTH CLASSIFICATION                                        │
└────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────┐
  │ if pIC50 > 7:    → STRONG binder       │
  │ if 5 ≤ pIC50 ≤ 7: → MEDIUM binder      │
  │ if pIC50 < 5:    → WEAK binder         │
  │                                         │
  │ Equivalently (in IC50):                │
  │   STRONG:  IC50 < 100 nM               │
  │   MEDIUM:  100 nM ≤ IC50 ≤ 10 μM       │
  │   WEAK:    IC50 > 10 μM                │
  └─────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────┐
│ 7. DEADLINESS SCORE                                                        │
└────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────┐
  │ Deadliness = (T + I + M + S) / 4 × 0.96│
  │                                         │
  │ where:                                  │
  │   T = Transmissibility (0-100)         │
  │   I = Immune evasion (0-100)           │
  │   M = Mortality rate (0-100)           │
  │   S = Infection severity (0-100)       │
  └─────────────────────────────────────────┘

  Risk Classification:
  ┌─────────────────────────────────────────┐
  │ CRITICAL: Score ≥ 80                   │
  │ HIGH:     60 ≤ Score < 80              │
  │ MEDIUM:   40 ≤ Score < 60              │
  │ LOW:      Score < 40                   │
  └─────────────────────────────────────────┘

  Example (SARS-CoV-2):
    T=82, I=75, M=65, S=74
    → (82+75+65+74)/4 × 0.96 = 71/100 (HIGH RISK)

┌────────────────────────────────────────────────────────────────────────────┐
│ 8. CHEMICAL MODIFICATION PREDICTION                                       │
└────────────────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────┐
  │ IC50_new = IC50_old × (1 - Δ/100)     │
  │                                         │
  │ where Δ = expected improvement (%)     │
  └─────────────────────────────────────────┘

  Example Modifications:
    Fluorination:    Δ = 15%  → IC50_new = IC50 × 0.85
    Hydroxylation:   Δ = 10%  → IC50_new = IC50 × 0.90
    Methylation:     Δ = 8%   → IC50_new = IC50 × 0.92

┌────────────────────────────────────────────────────────────────────────────┐
│ 9. MODEL EVALUATION METRICS                                               │
└────────────────────────────────────────────────────────────────────────────┘

  Root Mean Square Error:
  ┌─────────────────────────────────────────┐
  │ RMSE = √[(1/n) × Σ(y - ŷ)²]           │
  └─────────────────────────────────────────┘
  Current: 1.40 pIC50 units

  Pearson Correlation:
  ┌─────────────────────────────────────────┐
  │ r = Cov(y,ŷ) / (σy × σŷ)              │
  └─────────────────────────────────────────┘
  Current: 0.527 (test set)

  R² Score:
  ┌─────────────────────────────────────────┐
  │ R² = 1 - (SS_residual / SS_total)     │
  └─────────────────────────────────────────┘
  Current: 0.237 (test set)

┌────────────────────────────────────────────────────────────────────────────┐
│ 10. COMPLETE PREDICTION PIPELINE                                          │
└────────────────────────────────────────────────────────────────────────────┘

  INPUT: SMILES string
     ↓
  [1] Extract 27 features from SMILES
     ↓
  [2] Scale features: X_scaled = (X - μ) / σ
     ↓
  [3] Random Forest: pIC50 = Σ Trees / 300
     ↓
  [4] Convert: IC50_nM = 10^(9 - pIC50)
     ↓
  [5] Normalize: Score = (pIC50 - min) / range
     ↓
  [6] Classify: Strong/Medium/Weak
     ↓
  [7] Rank: Sort by Score (descending)
     ↓
  OUTPUT: Ranked drugs with IC50 estimates

═══════════════════════════════════════════════════════════════════════════

QUICK STATS:
  • Model: Random Forest (300 trees, depth=4)
  • Features: 27 (25 SMILES + 2 molecular)
  • Training samples: 81 (70-20-10 split)
  • Test correlation: 0.527
  • Inference speed: < 2 seconds for 190 drugs
  • Prediction range: IC50 from 1 nM to 100 μM

═══════════════════════════════════════════════════════════════════════════

